number of decayed parameter tensors: 26, with 11591680 parameters
number of non-decayed parameter tensors: 42, with 23552 parameters
using fused AdamW: False
Model path: ../../pretrained_models/test_j_train2.pth
Model configuration saved to: ../../pretrained_models/test_j_train2_config.txt
Using device: cuda
Using dtype: torch.float16
Training model for 1 epochs with 49320 batches per epoch.
Checkpoints will be saved every 986 batches.
Epoch 1/1, Batch 1/49320, Loss: 8.8073, Avg Time/batch: 1.0000 s, Avg Token Efficiency: 2899.23 tokens/s
Epoch 1/1, Batch 251/49320, Loss: 7.8617, Avg Time/batch: 0.1264 s, Avg Token Efficiency: 16204.04 tokens/s
Epoch 1/1, Batch 501/49320, Loss: 7.3864, Avg Time/batch: 0.1263 s, Avg Token Efficiency: 16221.67 tokens/s
Epoch 1/1, Batch 751/49320, Loss: 7.0200, Avg Time/batch: 0.1265 s, Avg Token Efficiency: 16193.63 tokens/s
Model checkpoint saved at batch 986 in epoch 1.
Epoch 1/1, Batch 1001/49320, Loss: 6.7000, Avg Time/batch: 0.1265 s, Avg Token Efficiency: 16185.17 tokens/s
Epoch 1/1, Batch 1251/49320, Loss: 6.5954, Avg Time/batch: 0.1264 s, Avg Token Efficiency: 16197.12 tokens/s
Epoch 1/1, Batch 1501/49320, Loss: 6.4708, Avg Time/batch: 0.1265 s, Avg Token Efficiency: 16193.26 tokens/s
Epoch 1/1, Batch 1751/49320, Loss: 6.2815, Avg Time/batch: 0.1265 s, Avg Token Efficiency: 16194.18 tokens/s
Model checkpoint saved at batch 1972 in epoch 1.
Epoch 1/1, Batch 2001/49320, Loss: 6.2012, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16174.92 tokens/s
Epoch 1/1, Batch 2251/49320, Loss: 5.9079, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16179.10 tokens/s
Epoch 1/1, Batch 2501/49320, Loss: 5.4639, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16176.32 tokens/s
Epoch 1/1, Batch 2751/49320, Loss: 5.8988, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16174.36 tokens/s
Model checkpoint saved at batch 2958 in epoch 1.
Epoch 1/1, Batch 3001/49320, Loss: 5.7182, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16164.10 tokens/s
Epoch 1/1, Batch 3251/49320, Loss: 5.7801, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16178.18 tokens/s
Epoch 1/1, Batch 3501/49320, Loss: 5.5652, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16174.13 tokens/s
Epoch 1/1, Batch 3751/49320, Loss: 5.3033, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16180.73 tokens/s
Model checkpoint saved at batch 3944 in epoch 1.
Epoch 1/1, Batch 4001/49320, Loss: 5.3390, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16169.08 tokens/s
Epoch 1/1, Batch 4251/49320, Loss: 5.0918, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16175.81 tokens/s
Epoch 1/1, Batch 4501/49320, Loss: 5.1687, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16176.28 tokens/s
Epoch 1/1, Batch 4751/49320, Loss: 4.9638, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16174.90 tokens/s
Model checkpoint saved at batch 4930 in epoch 1.
Epoch 1/1, Batch 5001/49320, Loss: 5.0724, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16169.12 tokens/s
Epoch 1/1, Batch 5251/49320, Loss: 5.0372, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16169.28 tokens/s
Epoch 1/1, Batch 5501/49320, Loss: 4.5586, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16167.47 tokens/s
Epoch 1/1, Batch 5751/49320, Loss: 4.8528, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16145.70 tokens/s
Model checkpoint saved at batch 5916 in epoch 1.
Epoch 1/1, Batch 6001/49320, Loss: 4.9859, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16100.65 tokens/s
Epoch 1/1, Batch 6251/49320, Loss: 4.6170, Avg Time/batch: 0.1271 s, Avg Token Efficiency: 16107.56 tokens/s
Epoch 1/1, Batch 6501/49320, Loss: 4.6385, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16094.87 tokens/s
Epoch 1/1, Batch 6751/49320, Loss: 4.7492, Avg Time/batch: 0.1280 s, Avg Token Efficiency: 16000.34 tokens/s
Model checkpoint saved at batch 6902 in epoch 1.
Epoch 1/1, Batch 7001/49320, Loss: 4.4908, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16047.44 tokens/s
Epoch 1/1, Batch 7251/49320, Loss: 4.1813, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16051.88 tokens/s
Epoch 1/1, Batch 7501/49320, Loss: 4.3446, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16055.91 tokens/s
Epoch 1/1, Batch 7751/49320, Loss: 3.4814, Avg Time/batch: 0.1278 s, Avg Token Efficiency: 16030.78 tokens/s
Model checkpoint saved at batch 7888 in epoch 1.
Epoch 1/1, Batch 8001/49320, Loss: 4.5495, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16056.46 tokens/s
Epoch 1/1, Batch 8251/49320, Loss: 4.3051, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16105.64 tokens/s
Epoch 1/1, Batch 8501/49320, Loss: 3.8605, Avg Time/batch: 0.1271 s, Avg Token Efficiency: 16107.88 tokens/s
Epoch 1/1, Batch 8751/49320, Loss: 4.2346, Avg Time/batch: 0.1271 s, Avg Token Efficiency: 16110.05 tokens/s
Model checkpoint saved at batch 8874 in epoch 1.
Epoch 1/1, Batch 9001/49320, Loss: 4.0400, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16105.33 tokens/s
Epoch 1/1, Batch 9251/49320, Loss: 3.9110, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16073.93 tokens/s
Epoch 1/1, Batch 9501/49320, Loss: 3.5782, Avg Time/batch: 0.1278 s, Avg Token Efficiency: 16030.42 tokens/s
Epoch 1/1, Batch 9751/49320, Loss: 3.8532, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16031.35 tokens/s
Model checkpoint saved at batch 9860 in epoch 1.
Epoch 1/1, Batch 10001/49320, Loss: 3.6078, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16015.92 tokens/s
Epoch 1/1, Batch 10251/49320, Loss: 3.1595, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16038.68 tokens/s
Epoch 1/1, Batch 10501/49320, Loss: 3.3372, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16044.43 tokens/s
Epoch 1/1, Batch 10751/49320, Loss: 3.2904, Avg Time/batch: 0.1278 s, Avg Token Efficiency: 16020.16 tokens/s
Model checkpoint saved at batch 10846 in epoch 1.
Epoch 1/1, Batch 11001/49320, Loss: 3.4581, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16014.18 tokens/s
Epoch 1/1, Batch 11251/49320, Loss: 3.4584, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16058.93 tokens/s
Epoch 1/1, Batch 11501/49320, Loss: 3.4798, Avg Time/batch: 0.1270 s, Avg Token Efficiency: 16128.01 tokens/s
Epoch 1/1, Batch 11751/49320, Loss: 3.0943, Avg Time/batch: 0.1271 s, Avg Token Efficiency: 16117.88 tokens/s
Model checkpoint saved at batch 11832 in epoch 1.
Epoch 1/1, Batch 12001/49320, Loss: 3.3571, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16045.28 tokens/s
Epoch 1/1, Batch 12251/49320, Loss: 2.8381, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16015.91 tokens/s
Epoch 1/1, Batch 12501/49320, Loss: 2.6151, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16014.78 tokens/s
Epoch 1/1, Batch 12751/49320, Loss: 2.4428, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16014.26 tokens/s
Model checkpoint saved at batch 12818 in epoch 1.
Epoch 1/1, Batch 13001/49320, Loss: 2.4038, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16009.01 tokens/s
Epoch 1/1, Batch 13251/49320, Loss: 2.9153, Avg Time/batch: 0.1279 s, Avg Token Efficiency: 16015.15 tokens/s
Epoch 1/1, Batch 13501/49320, Loss: 2.2834, Avg Time/batch: 0.1497 s, Avg Token Efficiency: 13683.06 tokens/s
Epoch 1/1, Batch 13751/49320, Loss: 2.9387, Avg Time/batch: 0.1829 s, Avg Token Efficiency: 11195.45 tokens/s
Model checkpoint saved at batch 13804 in epoch 1.
Epoch 1/1, Batch 14001/49320, Loss: 2.4079, Avg Time/batch: 0.1827 s, Avg Token Efficiency: 11210.08 tokens/s
Epoch 1/1, Batch 14251/49320, Loss: 2.3135, Avg Time/batch: 0.1824 s, Avg Token Efficiency: 11226.22 tokens/s
Epoch 1/1, Batch 14501/49320, Loss: 2.1342, Avg Time/batch: 0.1830 s, Avg Token Efficiency: 11192.63 tokens/s
Epoch 1/1, Batch 14751/49320, Loss: 2.0729, Avg Time/batch: 0.1826 s, Avg Token Efficiency: 11212.73 tokens/s
Model checkpoint saved at batch 14790 in epoch 1.
Epoch 1/1, Batch 15001/49320, Loss: 2.1335, Avg Time/batch: 0.1827 s, Avg Token Efficiency: 11207.92 tokens/s
Epoch 1/1, Batch 15251/49320, Loss: 1.9233, Avg Time/batch: 0.1830 s, Avg Token Efficiency: 11189.98 tokens/s
Epoch 1/1, Batch 15501/49320, Loss: 1.9543, Avg Time/batch: 0.1830 s, Avg Token Efficiency: 11191.20 tokens/s
Epoch 1/1, Batch 15751/49320, Loss: 1.9086, Avg Time/batch: 0.1825 s, Avg Token Efficiency: 11223.14 tokens/s
Model checkpoint saved at batch 15776 in epoch 1.
Epoch 1/1, Batch 16001/49320, Loss: 2.1134, Avg Time/batch: 0.1806 s, Avg Token Efficiency: 11342.65 tokens/s
Epoch 1/1, Batch 16251/49320, Loss: 1.7444, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16154.33 tokens/s
Epoch 1/1, Batch 16501/49320, Loss: 1.7660, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16163.22 tokens/s
Epoch 1/1, Batch 16751/49320, Loss: 1.6307, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16165.05 tokens/s
Model checkpoint saved at batch 16762 in epoch 1.
Epoch 1/1, Batch 17001/49320, Loss: 1.6669, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16134.86 tokens/s
Epoch 1/1, Batch 17251/49320, Loss: 1.5492, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16103.95 tokens/s
Epoch 1/1, Batch 17501/49320, Loss: 1.3185, Avg Time/batch: 0.1272 s, Avg Token Efficiency: 16095.65 tokens/s
Model checkpoint saved at batch 17748 in epoch 1.
Epoch 1/1, Batch 17751/49320, Loss: 1.5601, Avg Time/batch: 0.1273 s, Avg Token Efficiency: 16083.24 tokens/s
Epoch 1/1, Batch 18001/49320, Loss: 1.4668, Avg Time/batch: 0.1273 s, Avg Token Efficiency: 16082.68 tokens/s
Epoch 1/1, Batch 18251/49320, Loss: 1.1050, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16072.81 tokens/s
Epoch 1/1, Batch 18501/49320, Loss: 1.3568, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16077.92 tokens/s
Model checkpoint saved at batch 18734 in epoch 1.
Epoch 1/1, Batch 18751/49320, Loss: 1.1147, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16062.45 tokens/s
Epoch 1/1, Batch 19001/49320, Loss: 1.1135, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16075.36 tokens/s
Epoch 1/1, Batch 19251/49320, Loss: 1.4227, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16074.80 tokens/s
Epoch 1/1, Batch 19501/49320, Loss: 1.2303, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16068.26 tokens/s
Model checkpoint saved at batch 19720 in epoch 1.
Epoch 1/1, Batch 19751/49320, Loss: 1.1623, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16066.75 tokens/s
Epoch 1/1, Batch 20001/49320, Loss: 0.9470, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16062.80 tokens/s
Epoch 1/1, Batch 20251/49320, Loss: 1.2053, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16061.94 tokens/s
Epoch 1/1, Batch 20501/49320, Loss: 1.2022, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16061.79 tokens/s
Model checkpoint saved at batch 20706 in epoch 1.
Epoch 1/1, Batch 20751/49320, Loss: 1.0140, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16043.25 tokens/s
Epoch 1/1, Batch 21001/49320, Loss: 1.0171, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16051.06 tokens/s
Epoch 1/1, Batch 21251/49320, Loss: 0.8306, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16051.70 tokens/s
Epoch 1/1, Batch 21501/49320, Loss: 1.0508, Avg Time/batch: 0.1275 s, Avg Token Efficiency: 16057.20 tokens/s
Model checkpoint saved at batch 21692 in epoch 1.
Epoch 1/1, Batch 21751/49320, Loss: 0.7138, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16048.08 tokens/s
Epoch 1/1, Batch 22001/49320, Loss: 1.0582, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16048.22 tokens/s
Epoch 1/1, Batch 22251/49320, Loss: 0.8542, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16049.85 tokens/s
Epoch 1/1, Batch 22501/49320, Loss: 0.9518, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16074.71 tokens/s
Model checkpoint saved at batch 22678 in epoch 1.
Epoch 1/1, Batch 22751/49320, Loss: 0.9893, Avg Time/batch: 0.1274 s, Avg Token Efficiency: 16071.51 tokens/s
Epoch 1/1, Batch 23001/49320, Loss: 0.8739, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16051.36 tokens/s
Epoch 1/1, Batch 23251/49320, Loss: 0.8059, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16043.25 tokens/s
Epoch 1/1, Batch 23501/49320, Loss: 0.8896, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16038.95 tokens/s
Model checkpoint saved at batch 23664 in epoch 1.
Epoch 1/1, Batch 23751/49320, Loss: 0.6952, Avg Time/batch: 0.1277 s, Avg Token Efficiency: 16037.64 tokens/s
Epoch 1/1, Batch 24001/49320, Loss: 0.7843, Avg Time/batch: 0.1276 s, Avg Token Efficiency: 16048.79 tokens/s
Epoch 1/1, Batch 24251/49320, Loss: 0.8318, Avg Time/batch: 0.1661 s, Avg Token Efficiency: 12330.25 tokens/s
Epoch 1/1, Batch 24501/49320, Loss: 0.5692, Avg Time/batch: 0.1824 s, Avg Token Efficiency: 11230.49 tokens/s
Model checkpoint saved at batch 24650 in epoch 1.
Epoch 1/1, Batch 24751/49320, Loss: 0.6886, Avg Time/batch: 0.1824 s, Avg Token Efficiency: 11226.91 tokens/s
Epoch 1/1, Batch 25001/49320, Loss: 0.7598, Avg Time/batch: 0.1815 s, Avg Token Efficiency: 11285.05 tokens/s
Epoch 1/1, Batch 25251/49320, Loss: 0.9093, Avg Time/batch: 0.1819 s, Avg Token Efficiency: 11257.88 tokens/s
Epoch 1/1, Batch 25501/49320, Loss: 0.5791, Avg Time/batch: 0.1815 s, Avg Token Efficiency: 11283.04 tokens/s
Model checkpoint saved at batch 25636 in epoch 1.
Epoch 1/1, Batch 25751/49320, Loss: 0.8560, Avg Time/batch: 0.1819 s, Avg Token Efficiency: 11259.28 tokens/s
Epoch 1/1, Batch 26001/49320, Loss: 0.6152, Avg Time/batch: 0.1820 s, Avg Token Efficiency: 11254.21 tokens/s
Epoch 1/1, Batch 26251/49320, Loss: 0.6648, Avg Time/batch: 0.1819 s, Avg Token Efficiency: 11256.91 tokens/s
Epoch 1/1, Batch 26501/49320, Loss: 0.5996, Avg Time/batch: 0.1818 s, Avg Token Efficiency: 11266.73 tokens/s
Model checkpoint saved at batch 26622 in epoch 1.
Epoch 1/1, Batch 26751/49320, Loss: 0.7518, Avg Time/batch: 0.1534 s, Avg Token Efficiency: 13351.78 tokens/s
Epoch 1/1, Batch 27001/49320, Loss: 0.5695, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16173.35 tokens/s
Epoch 1/1, Batch 27251/49320, Loss: 0.5967, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16171.86 tokens/s
Epoch 1/1, Batch 27501/49320, Loss: 0.8159, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16177.14 tokens/s
Model checkpoint saved at batch 27608 in epoch 1.
Epoch 1/1, Batch 27751/49320, Loss: 0.7306, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16166.32 tokens/s
Epoch 1/1, Batch 28001/49320, Loss: 0.5758, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16167.54 tokens/s
Epoch 1/1, Batch 28251/49320, Loss: 0.5534, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16163.98 tokens/s
Epoch 1/1, Batch 28501/49320, Loss: 0.5810, Avg Time/batch: 0.1266 s, Avg Token Efficiency: 16172.27 tokens/s
Model checkpoint saved at batch 28594 in epoch 1.
Epoch 1/1, Batch 28751/49320, Loss: 0.6364, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16153.86 tokens/s
Epoch 1/1, Batch 29001/49320, Loss: 0.5992, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16149.03 tokens/s
Epoch 1/1, Batch 29251/49320, Loss: 0.5637, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16144.55 tokens/s
Epoch 1/1, Batch 29501/49320, Loss: 0.6231, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16153.53 tokens/s
Model checkpoint saved at batch 29580 in epoch 1.
Epoch 1/1, Batch 29751/49320, Loss: 0.5199, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16163.24 tokens/s
Epoch 1/1, Batch 30001/49320, Loss: 0.5819, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16163.49 tokens/s
Epoch 1/1, Batch 30251/49320, Loss: 0.5279, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16163.50 tokens/s
Epoch 1/1, Batch 30501/49320, Loss: 0.4427, Avg Time/batch: 0.1267 s, Avg Token Efficiency: 16164.24 tokens/s
Model checkpoint saved at batch 30566 in epoch 1.
Epoch 1/1, Batch 30751/49320, Loss: 0.5016, Avg Time/batch: 0.1268 s, Avg Token Efficiency: 16153.41 tokens/s
Epoch 1/1, Batch 31001/49320, Loss: 0.4527, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16142.90 tokens/s
Epoch 1/1, Batch 31251/49320, Loss: 0.7150, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16135.82 tokens/s
Epoch 1/1, Batch 31501/49320, Loss: 0.6042, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16140.84 tokens/s
Model checkpoint saved at batch 31552 in epoch 1.
Epoch 1/1, Batch 31751/49320, Loss: 0.6162, Avg Time/batch: 0.1271 s, Avg Token Efficiency: 16119.11 tokens/s
Epoch 1/1, Batch 32001/49320, Loss: 0.4709, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16138.45 tokens/s
Epoch 1/1, Batch 32251/49320, Loss: 0.5429, Avg Time/batch: 0.1270 s, Avg Token Efficiency: 16132.27 tokens/s
Epoch 1/1, Batch 32501/49320, Loss: 0.4908, Avg Time/batch: 0.1269 s, Avg Token Efficiency: 16135.69 tokens/s
Model checkpoint saved at batch 32538 in epoch 1.


(pacman_env) kevin@kevin-Alienware-17-R3:~/Desktop/transformer/tests/kevin_tests$ python train_test.py >> test_on_whole_code_focus_on_train_model.log
/home/kevin/Desktop/transformer/tests/kevin_tests/train.py:153: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly():
/home/kevin/anaconda3/envs/pacman_env/lib/python3.9/site-packages/torch/autograd/graph.py:825: UserWarning: Error detected in AddmmBackward0. No forward pass information available. Enable detect anomaly during forward pass for more information. (Triggered internally at ../torch/csrc/autograd/python_anomaly_mode.cpp:88.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Traceback (most recent call last):
  File "/home/kevin/Desktop/transformer/tests/kevin_tests/train_test.py", line 73, in <module>
    train_model(
  File "/home/kevin/Desktop/transformer/tests/kevin_tests/train.py", line 154, in train_model
    loss.backward()
  File "/home/kevin/anaconda3/envs/pacman_env/lib/python3.9/site-packages/torch/_tensor.py", line 581, in backward
    torch.autograd.backward(
  File "/home/kevin/anaconda3/envs/pacman_env/lib/python3.9/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/kevin/anaconda3/envs/pacman_env/lib/python3.9/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'AddmmBackward0' returned nan values in its 1th output.